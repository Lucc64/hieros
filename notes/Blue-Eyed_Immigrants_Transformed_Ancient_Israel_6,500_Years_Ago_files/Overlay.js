define("Purch/UI/Overlay",["jquery"],function(a){"use strict";var b=function(b){this.conf=a.extend({element:null,type:"",width:500,height:400},b||{}),!1!==this.conf.init&&this.init()};return b.prototype={init:function(){var b=this;if("image"==this.conf.type){var c=a(this.conf.element).attr("href");b.createBackground(),a("<img/>").attr("src",c).load(function(){b.conf.width=this.width,b.conf.height=this.height,b.appendHTML(b.createHTML("<img src='"+c+"' />")),b.closeOverlay()})}else"bzwidget"==this.conf.type&&a(".bz-form-widget").length>0&&(b.conf.width=a("#bz-form").width()+25,b.conf.height=a("#bz-form").height()+25,b.createBackground(),b.appendHTML(b.createHTML('<div class="bz-form-widget"></div>')),b.closeOverlay())},createBackground:function(){a("body").append("<div id='overlay' class='generic-overlay'></div>"),a("body").css("overflow","hidden"),a("#overlay").addClass("show")},createHTML:function(a){return"<div class='overlay-content overlay-"+this.conf.type+"'><div class='overlay-wrapper'><span class='close'></span>"+a+"</div></div>"},appendHTML:function(b){var c=this;a("#overlay").append(b),"bzwidget"==c.conf.type&&a("#overlay .bz-form-widget").append(a("#bz-form")),a(".overlay-wrapper").css({"margin-top":c.conf.height/2*-1,"margin-left":c.conf.width/2*-1,width:c.conf.width,height:c.conf.height})},closeOverlay:function(){var b=this;a("#overlay .close").on("click",function(){"bzwidget"==b.conf.type&&a(".articleBody .bz-form-widget:first").append(a("#bz-form")),a("#overlay").removeClass("show"),a("body").css("overflow","visible"),a("#overlay").remove()}),a("#overlay, .overlay-content").on("click",function(b){b.target===this&&a("#overlay .close").click()}),a(document).keyup(function(b){a("#overlay").hasClass("show")&&27==b.keyCode&&a("#overlay .close").click()})}},b});