<html>

<h1>Manual of Fragment Editor</h1>

The panel is subdivided into:
<ul>
<li> a small panel in the top-left or top-right corner,
for direction and size,
<li> a narrow preview panel and 
<li> a main tree panel. 
</ul> 
The preview panel presents the fragment
in graphical form.
The tree panel presents RES in an hierarchical format;
below compound expressions we find their subexpressions,
as square nodes connected by edges.
<p>
As soon as the RES expression has at least one group,
one distinguished subexpression will be the 'focus'. 
The focus is the target of edit operations.
In the tree panel, the focus is indicated by a blue boundary
around a node, as opposed to a gray boundary.
In the preview panel, the group containing the focus is
indicated by a blue square. The focus can also be the space 
between two groups.
<p>
In the tree panel, the focus can be changed by clicking on a node.
In the preview panel, the top-most node of a group can be
made the focus by clicking on that group; one may also click
on the white space between two groups. 
In addition, the four arrow keys can be used to move the focus.
The 'Home' and 'End' keys move the focus to the first group and
the last group respectively.
<p>
A separate window, which we will call the legend, presents properties
of the subexpression that is the current focus, and the available
options to change those properties as well as to make 
structural changes to the fragment. For most kinds of groups,
there is a preview of the group at the top of the legend, which displays
properties of a subexpression as they are changed.
Changed properties have effect in the tree panel and in the preview
panel upon clicking <b>apply</b> in the legend, or by changing the
focus. To restore changed properties that have not yet been propagated to
the tree and preview panels, click <b>restore</b>. The button
<b>default</b> sets the properties to their defaults.

<h2>Introductory example</h2>

Groups are constructed from the bottom up, and from left to right
(or right to left, depending on the text direction).
For example, to construct
<tt>cartouche(N5-N28:f)</tt>, one first constructs 
<tt>N5</tt>, which is then placed in a cartouche.
Thereafter <tt>N28</tt> is added, then the operator '<tt>:</tt>'
and sign <tt>f</tt>. In terms of mouse clicks and keyboard input
in the legend, the group can be obtained by the following:
<ol>
<li> Click <b>named</b> and fill in 'N5' as name;
<li> Click <b>box</b>;
<li> Click <b>-</b> and fill in 'N28' as name;
<li> Click <b>:</b> and fill in 'f' as name;
<li> Click <b>apply</b>.
</ol>

<h2>Changing the structure</h2>

The legend offers a number of options to change the structure of a
group, from the viewpoint of the element that currently holds the focus. 
Not all options are available for all kinds of elements. Let us look 
at the complete range of structural operations:
<ul>
<li> <b>named</b> creates a new group consisting of only a named glyph.
If the current focus is an empty glyph, it is replaced by the named glyph.
If the current focus is a box, the new group is placed at the beginning of
the content of the box.
<li> <b>empty</b> creates a new group consisting of only an empty glyph,
and behaves similarly to <b>named</b>.
<li> '<b>.</b>' creates a point glyph, i.e., a special kind of empty glyph, of
which the width and height are zero. 
<li> '<b>*</b>' creates a new horizontal group, 
of which the current focus becomes the first part, 
and the second part consists of a newly created named glyph,
which thereupon receives the focus. If however, the current focus is already
part of a horizontal group, a new named glyph is created after the element of
the current focus.
If the current focus is an operator however, 
then the groups on either side are merged into a horizontal group.
<li> '<b>:</b>' behaves similarly, for vertical groups.
<li> '<b>+</b>' and '<b>;</b>' can be used to insert elements
<em>before</em> the current focus, in a horizontal group
and vertical group, respectively.
<li> '<b>^</b>' creates a note attached to the current focus.
<li> '<b>!</b>' creates a switch. Observe that switches that have no
parameters may disappear again after a structural change.
In a box, there is a distinction between a switch at the beginning of the
contents, and a switch after the box itself; similarly for
insert, modify and stack.
<li> '<b>-</b>' creates a new group following the current one.
<li> <b>box</b> creates a new box, of which the current focus becomes the
first part.
<li> <b>modify</b> creates modification, with the current focus
as the argument.
<li> Similarly, <b>insert</b> and <b>stack</b> create
a new element in the structure, of which the current focus becomes the
first argument.
If the current focus is an operator however, 
then the groups on either side become the two arguments of an insert or
stack.
<li> <b>delete</b> removes the current element. This may lead to a 
cascade of further changes to preserve the integrity of the syntax
of RES. For example, if <tt>B1</tt> is removed from <tt>A1*B1</tt>,
then the operator '<tt>*</tt>' also needs to be removed, and <tt>A1</tt> is
left. Because the integrity of the syntax needs to be preserved,
not all delete actions can be executed. For example, deleting the horizontal
node in '<tt>modify(A1*B1)</tt>' cannot be allowed.
</ul>

<h2>Keyboard shortcuts</h2>

Use of the mouse can to a great extent be avoided by keyboard shortcuts.
Buttons in the legend that change the structure of groups
can be activated from the main window by keys (or key combinations) such as
'<tt>*</tt>', '<tt>:</tt>', '<tt>-</tt>', '<tt>^</tt>', '<tt>!</tt>',
the 'delete' key for <b>delete</b>, 
'<tt>a</tt>' for <b>apply</b>,
'<tt>e</tt>' for <b>empty</b>, 
'<tt>b</tt>' for <b>box</b>, etc. 
<p>
In addition, the name of a glyph can be entered from the keyboard, provided
the relevant field has the focus; the focus can be toggled by <tt>Enter</tt>.
The same holds for the text of a note.
Remark that to activate for example <b>empty</b>
through key '<tt>e</tt>' in the main window, the text field for the name 
of a glyph should not have the focus. This is not relevant however for 
activating <b>menu</b> by key '<tt>u</tt>', as the u may never occur in
the name of a glyph.
<p>
It is important to remember that for the keyboard shortcuts to work, 
the focus has to be in the main window. 
If the legend holds the focus, you need to click the buttons instead.

<h1>Glyph chooser</h1>

By clicking the tabs at the top of the window, one may view categories of
signs according to Gardiner's sign list. Three extra tabs show collections
of signs according to shape. Alternatively, one may navigate through the tabs
using the left and right arrow keys. The tab <b>Tall</b> may be activated by
hitting <tt>Alt+T</tt> (or <tt>Command+T</tt> on Mac OS X);
broad and narrow signs are activated by <tt>Alt+B</tt> (or <tt>Command+B</tt>)
and <tt>Alt+A</tt> (or <tt>Command+A</tt>). 
Left-clicking a glyph selects it, and inserts it in the Legend.
<p>
Another way of choosing glyphs is by typing the 'Gardiner' name of a glyph 
on the keyboard. The name typed so far is represented at the top of the
window. The name is represented in red unless it is a complete valid sign name in
the known sign list, in which case it is represented in blue.
The category 'Aa' should be entered as <tt>J</tt>.
Upon entering the category, the corresponding tab is activated.
Activation of a tab is avoided if the category is entered in lower-case
(<tt>j</tt> for 'Aa'). Typed keys can be undone by hitting <tt>Backspace</tt>.
A glyph is selected by <tt>Enter</tt>.
<p>
Information on signs can be obtained by clicking <b>Info</b> and moving the 
mouse over a sign.

<h1>Buttons in the menus</h1>

<h2>Close</h2>

Saves and closes the editor.

<h2>Undo</h2>

Undoes last edit.

<h2>Redo</h2>

Converse of undo.

<h2>Clear</h2>

Remove all signs.

<h2>Normalize</h2>

Normalizes hieroglyphic encoding:
<ul>
<li> Rotation: replaces e.g. <tt>T15</tt> by <tt>T14[rotate=10]</tt>.
<li> Repetition: replace e.g. <tt>Z2</tt> by <tt>Z1*Z1*Z1</tt>.
</ul>

<h2>Flatten</h2>

Flattens structure to linear sequence of signs.

<h2>Swap</h2>

Swaps current sign and next one.

<h2>Preview</h2>

Changes fontsize in display of preview panel.

<h2>Tree</h2>

Changes fontsize in display of tree panel.

<h2>Help</h2>

Opens this subwindow.

</html>
